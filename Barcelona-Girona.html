<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>POST MATCH SUMMARY REPORT Barcelona–Girona La Liga 10.12.2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="Barcelona-Girona_files/libs/clipboard/clipboard.min.js"></script>
<script src="Barcelona-Girona_files/libs/quarto-html/quarto.js"></script>
<script src="Barcelona-Girona_files/libs/quarto-html/popper.min.js"></script>
<script src="Barcelona-Girona_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Barcelona-Girona_files/libs/quarto-html/anchor.min.js"></script>
<link href="Barcelona-Girona_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Barcelona-Girona_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Barcelona-Girona_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Barcelona-Girona_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Barcelona-Girona_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#match-preview" id="toc-match-preview" class="nav-link active" data-scroll-target="#match-preview">Match Preview</a></li>
  <li><a href="#head-2-head" id="toc-head-2-head" class="nav-link" data-scroll-target="#head-2-head">Head 2 Head</a></li>
  <li><a href="#pre-match-odds" id="toc-pre-match-odds" class="nav-link" data-scroll-target="#pre-match-odds">Pre Match Odds</a></li>
  <li><a href="#a.dovbyk-score" id="toc-a.dovbyk-score" class="nav-link" data-scroll-target="#a.dovbyk-score">A.Dovbyk Score</a></li>
  <li><a href="#match-summary---key-statistics" id="toc-match-summary---key-statistics" class="nav-link" data-scroll-target="#match-summary---key-statistics">Match Summary - Key Statistics</a></li>
  <li><a href="#attempts-at-goal" id="toc-attempts-at-goal" class="nav-link" data-scroll-target="#attempts-at-goal">Attempts at Goal</a></li>
  <li><a href="#passes-networks" id="toc-passes-networks" class="nav-link" data-scroll-target="#passes-networks">Passes Networks</a></li>
  <li><a href="#cumulative-xg" id="toc-cumulative-xg" class="nav-link" data-scroll-target="#cumulative-xg">Cumulative xG</a></li>
  <li><a href="#radar-chart" id="toc-radar-chart" class="nav-link" data-scroll-target="#radar-chart">Radar chart</a></li>
  <li><a href="#comparison-of-player-statistics" id="toc-comparison-of-player-statistics" class="nav-link" data-scroll-target="#comparison-of-player-statistics">Comparison of player statistics</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Barcelona-Girona.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">POST MATCH SUMMARY REPORT Barcelona–Girona La Liga 10.12.2023</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="match-preview" class="level2">
<h2 class="anchored" data-anchor-id="match-preview">Match Preview</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/weather.png" class="img-fluid figure-img"></p>
<figcaption>weather.png</figcaption>
</figure>
</div>
</section>
<section id="head-2-head" class="level2">
<h2 class="anchored" data-anchor-id="head-2-head">Head 2 Head</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/club_stats.png" class="img-fluid figure-img"></p>
<figcaption>club stats.png</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/history2.png" class="img-fluid figure-img"></p>
<figcaption>history2.png</figcaption>
</figure>
</div>
</section>
<section id="pre-match-odds" class="level2">
<h2 class="anchored" data-anchor-id="pre-match-odds">Pre Match Odds</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/odds.png" class="img-fluid figure-img"></p>
<figcaption>odds.png</figcaption>
</figure>
</div>
</section>
<section id="a.dovbyk-score" class="level2">
<h2 class="anchored" data-anchor-id="a.dovbyk-score">A.Dovbyk Score</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/Dovbyk2.png" class="img-fluid figure-img"></p>
<figcaption>Dovbyk2.png</figcaption>
</figure>
</div>
</section>
<section id="match-summary---key-statistics" class="level2">
<h2 class="anchored" data-anchor-id="match-summary---key-statistics">Match Summary - Key Statistics</h2>
<div id="27c467e2-0830-4cc2-9d56-58e310a49871" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data from the sofascore file</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data/merged_match_data.json'</span>, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    match_statistics <span class="op">=</span> json.load(f)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_stats_data(group):</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> []</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    first_team_values <span class="op">=</span> []</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    second_team_values <span class="op">=</span> []</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sub_item <span class="kw">in</span> group[<span class="st">'statisticsItems'</span>]:</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        labels.append(sub_item[<span class="st">'name'</span>])</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        first_team_values.append(sub_item[<span class="st">'homeValue'</span>])</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        second_team_values.append(sub_item[<span class="st">'awayValue'</span>])</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> ax.barh(labels, first_team_values, color<span class="op">=</span><span class="st">'#004D98'</span>, label<span class="op">=</span><span class="st">'Barcelona'</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> ax.barh(labels, [<span class="op">-</span>val <span class="cf">for</span> val <span class="kw">in</span> second_team_values], color<span class="op">=</span><span class="st">'#cd2534'</span>, label<span class="op">=</span><span class="st">'Girona'</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> rect <span class="kw">in</span> p1:</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        width <span class="op">=</span> rect.get_width()</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        ax.text(width, rect.get_y() <span class="op">+</span> rect.get_height() <span class="op">/</span> <span class="dv">2</span>, <span class="ss">f'</span><span class="sc">{</span><span class="bu">round</span>(width, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'left'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> rect <span class="kw">in</span> p2:</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        width <span class="op">=</span> rect.get_width()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        ax.text(width, rect.get_y() <span class="op">+</span> rect.get_height() <span class="op">/</span> <span class="dv">2</span>, <span class="ss">f'</span><span class="sc">{</span><span class="bu">round</span>(<span class="op">-</span>width, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'right'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Value'</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Group </span><span class="sc">{</span>group[<span class="st">"groupName"</span>]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove x-axis ticks</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="0dd89b5f-d9fd-4a7f-86a9-81685f32f0ab" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="167be16f-6d6b-4646-bfa4-60ab3313e83d" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your JSON is stored in a variable named 'match_statistics'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="35d1aa5b-dbe1-4d90-9f0f-04bfd105dbbd" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="2c1ec445-3bef-4964-8d92-85968ae0a24d" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d9fecd69-919c-4ac7-933c-cff0fd17d094" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="02961e34-65f5-4b87-89f8-2e60d289a5d6" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="aca1994b-2f40-4070-962f-99cebf095b8f" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="57de17a7-8599-460e-889b-d5600dbb5b3d" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="76ccbe5f-730e-4ee6-840d-60246a62cdf6" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>show_stats_data(match_statistics[<span class="st">'0'</span>][<span class="st">'statistics'</span>][<span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="attempts-at-goal" class="level2">
<h2 class="anchored" data-anchor-id="attempts-at-goal">Attempts at Goal</h2>
<div id="85f7f5fc-25c0-4e2a-b7de-f3a99d041c0a" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mplsoccer <span class="im">import</span> Pitch</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mplsoccer.pitch <span class="im">import</span> VerticalPitch</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data from the sofascore file</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data/sofascore/shots.json'</span>, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    shotmap_data <span class="op">=</span> json.load(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b81a6c62-96b1-4cc5-a3cc-fb0158a1b3bc" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract shot data for Girona</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>shots <span class="op">=</span> shotmap_data[<span class="st">'shotmap'</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an mplsoccer Pitch</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>pitch <span class="op">=</span> Pitch(pitch_type<span class="op">=</span><span class="st">'opta'</span>, pitch_color<span class="op">=</span><span class="st">'#22312b'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the shots on the pitch</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> pitch.draw(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate goal and non-goal shots for Girona at away games</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>girona_goal_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> shots <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">False</span> <span class="kw">and</span> shot[<span class="st">'shotType'</span>] <span class="op">==</span> <span class="st">'goal'</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>girona_non_goal_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> shots <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">False</span> <span class="kw">and</span> shot[<span class="st">'shotType'</span>] <span class="op">!=</span> <span class="st">'goal'</span>]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Girona non-goal shots with hatch</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> shot <span class="kw">in</span> girona_non_goal_shots:</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'x'</span>]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'y'</span>]</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    xg <span class="op">=</span> shot[<span class="st">'xg'</span>]</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    pitch.scatter(x, y, s<span class="op">=</span>(xg <span class="op">*</span> <span class="dv">1600</span>) <span class="op">+</span> <span class="dv">100</span>, edgecolors<span class="op">=</span><span class="st">'#b94b75'</span>, c<span class="op">=</span><span class="st">'None'</span>, hatch<span class="op">=</span><span class="st">'///'</span>, marker<span class="op">=</span><span class="st">'o'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Girona goal shots with a color</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> shot <span class="kw">in</span> girona_goal_shots:</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'x'</span>]</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'y'</span>]</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    xg <span class="op">=</span> shot[<span class="st">'xg'</span>]</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    pitch.scatter(x, y, s<span class="op">=</span>(xg <span class="op">*</span> <span class="dv">1600</span>) <span class="op">+</span> <span class="dv">100</span>, edgecolors<span class="op">=</span><span class="st">'#b94b75'</span>, linewidths<span class="op">=</span><span class="fl">0.6</span>, c<span class="op">=</span><span class="st">'white'</span>, marker<span class="op">=</span><span class="st">'football'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate goal and non-goal shots for Barcelona at home games</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>barcelona_goal_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> shots <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">True</span> <span class="kw">and</span> shot[<span class="st">'shotType'</span>] <span class="op">==</span> <span class="st">'goal'</span>]</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>barcelona_non_goal_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> shots <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">True</span> <span class="kw">and</span> shot[<span class="st">'shotType'</span>] <span class="op">!=</span> <span class="st">'goal'</span>]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Barcelona non-goal shots with hatch</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> shot <span class="kw">in</span> barcelona_non_goal_shots:</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'x'</span>]</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'y'</span>]</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    xg <span class="op">=</span> shot[<span class="st">'xg'</span>]</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    pitch.scatter(x, y, s<span class="op">=</span>(xg <span class="op">*</span> <span class="dv">1600</span>) <span class="op">+</span> <span class="dv">100</span>, edgecolors<span class="op">=</span><span class="st">'#b94b75'</span>, c<span class="op">=</span><span class="st">'None'</span>, hatch<span class="op">=</span><span class="st">'///'</span>, marker<span class="op">=</span><span class="st">'o'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Barcelona goal shots with a color</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> shot <span class="kw">in</span> barcelona_goal_shots:</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'x'</span>]</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'y'</span>]</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    xg <span class="op">=</span> shot[<span class="st">'xg'</span>]</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    pitch.scatter(x, y, s<span class="op">=</span>(xg <span class="op">*</span> <span class="dv">1600</span>) <span class="op">+</span> <span class="dv">100</span>, edgecolors<span class="op">=</span><span class="st">'#b94b75'</span>, linewidths<span class="op">=</span><span class="fl">0.6</span>, c<span class="op">=</span><span class="st">'white'</span>, marker<span class="op">=</span><span class="st">'football'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Add title</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ax.text(x<span class="op">=</span><span class="dv">25</span>, y<span class="op">=</span><span class="dv">10</span>, s<span class="op">=</span><span class="st">'Barcelona shots'</span>, size<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>pitch.line_color, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ax.text(x<span class="op">=</span><span class="dv">75</span>, y<span class="op">=</span><span class="dv">10</span>, s<span class="op">=</span><span class="st">'Girona shots'</span>, size<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>pitch.line_color, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ax.text(x<span class="op">=</span><span class="dv">25</span>, y<span class="op">=</span><span class="dv">5</span>, s<span class="op">=</span><span class="st">'xG - 3.74'</span>, size<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>pitch.line_color, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ax.text(x<span class="op">=</span><span class="dv">75</span>, y<span class="op">=</span><span class="dv">5</span>, s<span class="op">=</span><span class="st">'xG - 2.48'</span>, size<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>pitch.line_color, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="283eae45-470f-4f4e-8c32-44e6d534ebaf" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract shot data for Girona</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>girona_shots <span class="op">=</span> shotmap_data[<span class="st">'shotmap'</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an mplsoccer Pitch</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>pitch <span class="op">=</span> VerticalPitch(pitch_type<span class="op">=</span><span class="st">'opta'</span>, pitch_color<span class="op">=</span><span class="st">'#22312b'</span>, half<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the shots on the pitch</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> pitch.draw(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary to map shot types to colors</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>shot_type_colors <span class="op">=</span> {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'goal'</span>: <span class="st">'#d43939'</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'block'</span>: <span class="st">'#8a8181'</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'miss'</span>: <span class="st">'#fdae61'</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'save'</span>: <span class="st">'#3b8eaa'</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate goal and non-goal shots for Girona at away games</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>girona_goal_shots_away <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> girona_shots <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">False</span>]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot non-goal shots with hatch</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, shot <span class="kw">in</span> <span class="bu">enumerate</span>(girona_goal_shots_away):</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'y'</span>]</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'x'</span>]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    xg <span class="op">=</span> shot[<span class="st">'xg'</span>]</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    shot_type <span class="op">=</span> shot[<span class="st">'shotType'</span>]</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> shot_type_colors.get(shot_type)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x, y, s<span class="op">=</span>(xg <span class="op">*</span> <span class="dv">1900</span>) <span class="op">+</span> <span class="dv">100</span>, edgecolors<span class="op">=</span><span class="st">'white'</span>, c<span class="op">=</span>color, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    ax.text(x, y, s<span class="op">=</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>), color<span class="op">=</span><span class="st">'white'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add title</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ax.text(x<span class="op">=</span><span class="dv">50</span>, y<span class="op">=</span><span class="dv">60</span>, s<span class="op">=</span><span class="st">'Girona Shots'</span>, size<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>pitch.line_color, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend for shot types</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [plt.Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'w'</span>, label<span class="op">=</span>shot_type, markerfacecolor<span class="op">=</span>color, markersize<span class="op">=</span><span class="dv">10</span>) <span class="cf">for</span> shot_type, color <span class="kw">in</span> shot_type_colors.items()]</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper right'</span>, title<span class="op">=</span><span class="st">'Shot Type'</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1f99378c-7961-4135-9817-0b8d34a600d1" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract shot data for Girona</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>shots <span class="op">=</span> shotmap_data[<span class="st">'shotmap'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to plot the football goal, shots, and goal area</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_goal_shots_and_area(shotmap_data):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a football goal plot</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'lightgrey'</span>)  <span class="co"># Set background color</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    ax.plot([<span class="op">-</span><span class="dv">20</span>, <span class="op">-</span><span class="dv">20</span>, <span class="dv">120</span>, <span class="dv">120</span>, <span class="op">-</span><span class="dv">20</span>], [<span class="dv">0</span>, <span class="dv">120</span>, <span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">0</span>], color<span class="op">=</span><span class="st">'black'</span>)  <span class="co"># Football goal outline</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    girona_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> shotmap_data <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">False</span>]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scatter shots on the goal for non-home shots</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, shot <span class="kw">in</span> <span class="bu">enumerate</span>(girona_shots):</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> shot[<span class="st">'shotType'</span>] <span class="op">!=</span> <span class="st">'block'</span>:</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>            goal_coordinates <span class="op">=</span> shot[<span class="st">'draw'</span>][<span class="st">'goal'</span>]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>            shot_type <span class="op">=</span> shot[<span class="st">'shotType'</span>]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> shot_type_colors.get(shot_type)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>]) <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                ax.scatter(<span class="dv">50</span> <span class="op">-</span> ((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>])<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="dv">100</span>, marker<span class="op">=</span><span class="st">'o'</span>, edgecolors<span class="op">=</span><span class="st">'white'</span>, c<span class="op">=</span>color)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                ax.text(<span class="dv">50</span> <span class="op">-</span> ((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>])<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>), color<span class="op">=</span><span class="st">'white'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>                ax.scatter(<span class="dv">50</span> <span class="op">+</span> (<span class="bu">abs</span>((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>]))<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="dv">100</span>, marker<span class="op">=</span><span class="st">'o'</span>, edgecolors<span class="op">=</span><span class="st">'white'</span>, c<span class="op">=</span>color)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>                ax.text(<span class="dv">50</span> <span class="op">+</span> (<span class="bu">abs</span>((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>]))<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>), color<span class="op">=</span><span class="st">'white'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw the football goal area</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    goal_area_x <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">75</span>, <span class="dv">75</span>, <span class="dv">25</span>]</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    goal_area_y <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    ax.plot(goal_area_x, goal_area_y, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, label<span class="op">=</span><span class="st">'Goal Area'</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hide axis labels and ticks</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks([])</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels([])</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    ax.set_yticklabels([])</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Girona Shoots'</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add legend for shot types</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    legend_elements <span class="op">=</span> [plt.Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'w'</span>, label<span class="op">=</span>shot_type, markerfacecolor<span class="op">=</span>color, markersize<span class="op">=</span><span class="dv">10</span>) <span class="cf">for</span> shot_type, color <span class="kw">in</span> shot_type_colors.items()]</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper right'</span>, title<span class="op">=</span><span class="st">'Shot Type'</span>)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show the plot</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function with your shotmap data</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>plot_goal_shots_and_area(shots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="9cb3346d-4eb5-4348-a86d-6a7114969306" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract shot data for Girona</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>barcelona_shots <span class="op">=</span> shotmap_data[<span class="st">'shotmap'</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an mplsoccer Pitch</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>pitch <span class="op">=</span> VerticalPitch(pitch_type<span class="op">=</span><span class="st">'opta'</span>, pitch_color<span class="op">=</span><span class="st">'#22312b'</span>, half<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the shots on the pitch</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> pitch.draw(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary to map shot types to colors</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>shot_type_colors <span class="op">=</span> {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'goal'</span>: <span class="st">'#d43939'</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'block'</span>: <span class="st">'#8a8181'</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'miss'</span>: <span class="st">'#fdae61'</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'save'</span>: <span class="st">'#3b8eaa'</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate goal and non-goal shots for Girona at away games</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>barcelona_goal_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> barcelona_shots <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot non-goal shots with hatch</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, shot <span class="kw">in</span> <span class="bu">enumerate</span>(barcelona_goal_shots):</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'y'</span>]</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> shot[<span class="st">'playerCoordinates'</span>][<span class="st">'x'</span>]</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    xg <span class="op">=</span> shot[<span class="st">'xg'</span>]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    shot_type <span class="op">=</span> shot[<span class="st">'shotType'</span>]</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> shot_type_colors.get(shot_type)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x, y, s<span class="op">=</span>(xg <span class="op">*</span> <span class="dv">1900</span>) <span class="op">+</span> <span class="dv">100</span>, edgecolors<span class="op">=</span><span class="st">'white'</span>, c<span class="op">=</span>color, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    ax.text(x, y, s<span class="op">=</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>), color<span class="op">=</span><span class="st">'white'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Add title</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ax.text(x<span class="op">=</span><span class="dv">50</span>, y<span class="op">=</span><span class="dv">60</span>, s<span class="op">=</span><span class="st">'Barcelona Shots'</span>, size<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>pitch.line_color, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend for shot types</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [plt.Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'w'</span>, label<span class="op">=</span>shot_type, markerfacecolor<span class="op">=</span>color, markersize<span class="op">=</span><span class="dv">10</span>) <span class="cf">for</span> shot_type, color <span class="kw">in</span> shot_type_colors.items()]</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper right'</span>, title<span class="op">=</span><span class="st">'Shot Type'</span>)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="0af14b8d-83b4-41ad-9eb9-c604ba5fa1dd" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to plot the football goal, shots, and goal area</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_goal_shots_and_area(shotmap_data):</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a football goal plot</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor(<span class="st">'lightgrey'</span>)  <span class="co"># Set background color</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    ax.plot([<span class="op">-</span><span class="dv">20</span>, <span class="op">-</span><span class="dv">20</span>, <span class="dv">120</span>, <span class="dv">120</span>, <span class="op">-</span><span class="dv">20</span>], [<span class="dv">0</span>, <span class="dv">120</span>, <span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">0</span>], color<span class="op">=</span><span class="st">'black'</span>)  <span class="co"># Football goal outline</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    girona_shots <span class="op">=</span> [shot <span class="cf">for</span> shot <span class="kw">in</span> shotmap_data <span class="cf">if</span> shot[<span class="st">'isHome'</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scatter shots on the goal for non-home shots</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, shot <span class="kw">in</span> <span class="bu">enumerate</span>(girona_shots):</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> shot[<span class="st">'shotType'</span>] <span class="op">!=</span> <span class="st">'block'</span>:</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>            goal_coordinates <span class="op">=</span> shot[<span class="st">'draw'</span>][<span class="st">'goal'</span>]</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>            shot_type <span class="op">=</span> shot[<span class="st">'shotType'</span>]</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            color <span class="op">=</span> shot_type_colors.get(shot_type)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>]) <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                ax.scatter(<span class="dv">50</span> <span class="op">-</span> ((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>])<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="dv">100</span>, marker<span class="op">=</span><span class="st">'o'</span>, edgecolors<span class="op">=</span><span class="st">'white'</span>, c<span class="op">=</span>color)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                ax.text(<span class="dv">50</span> <span class="op">-</span> ((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>])<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>), color<span class="op">=</span><span class="st">'white'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                ax.scatter(<span class="dv">50</span> <span class="op">+</span> (<span class="bu">abs</span>((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>]))<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="dv">100</span>, marker<span class="op">=</span><span class="st">'o'</span>, edgecolors<span class="op">=</span><span class="st">'white'</span>, c<span class="op">=</span>color)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                ax.text(<span class="dv">50</span> <span class="op">+</span> (<span class="bu">abs</span>((<span class="dv">50</span> <span class="op">-</span> goal_coordinates[<span class="st">'x'</span>]))<span class="op">*</span><span class="dv">5</span>), (<span class="dv">100</span> <span class="op">-</span> goal_coordinates[<span class="st">'y'</span>])<span class="op">/</span><span class="fl">1.7</span>, s<span class="op">=</span><span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>), color<span class="op">=</span><span class="st">'white'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw the football goal area</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    goal_area_x <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">75</span>, <span class="dv">75</span>, <span class="dv">25</span>]</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    goal_area_y <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    ax.plot(goal_area_x, goal_area_y, color<span class="op">=</span><span class="st">'gray'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, label<span class="op">=</span><span class="st">'Goal Area'</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hide axis labels and ticks</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks([])</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels([])</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    ax.set_yticklabels([])</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Barcelona Shoots'</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add legend for shot types</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    legend_elements <span class="op">=</span> [plt.Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'w'</span>, label<span class="op">=</span>shot_type, markerfacecolor<span class="op">=</span>color, markersize<span class="op">=</span><span class="dv">10</span>) <span class="cf">for</span> shot_type, color <span class="kw">in</span> shot_type_colors.items()]</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper right'</span>, title<span class="op">=</span><span class="st">'Shot Type'</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show the plot</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function with your shotmap data</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>plot_goal_shots_and_area(shots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="passes-networks" class="level2">
<h2 class="anchored" data-anchor-id="passes-networks">Passes Networks</h2>
<div id="e0c7e18d-2a70-4b84-9348-4d3f68691578" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.font_manager <span class="im">import</span> FontManager</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> to_rgba</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mplsoccer <span class="im">import</span> Pitch</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"./data/WhoScored/match_1734731.json"</span>) <span class="im">as</span> f:</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    data_dict <span class="op">=</span> json.load(f)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#data_dict.keys()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="300698e8-589f-4635-bde0-979cc3f894d8" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_data_from_dict(data):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># load data from json</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    event_types_json <span class="op">=</span> data[<span class="st">"matchCentreEventTypeJson"</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    formation_mappings <span class="op">=</span> data[<span class="st">"formationIdNameMappings"</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    events_dict <span class="op">=</span> data[<span class="st">"matchCentreData"</span>][<span class="st">"events"</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    teams_dict <span class="op">=</span> {data[<span class="st">"matchCentreData"</span>][<span class="st">'home'</span>][<span class="st">'teamId'</span>]: data[<span class="st">"matchCentreData"</span>][<span class="st">'home'</span>][<span class="st">'name'</span>],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                  data[<span class="st">"matchCentreData"</span>][<span class="st">'away'</span>][<span class="st">'teamId'</span>]: data[<span class="st">"matchCentreData"</span>][<span class="st">'away'</span>][<span class="st">'name'</span>]}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    players_dict <span class="op">=</span> data[<span class="st">"matchCentreData"</span>][<span class="st">"playerIdNameDictionary"</span>]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create players dataframe</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    players_home_df <span class="op">=</span> pd.DataFrame(data[<span class="st">"matchCentreData"</span>][<span class="st">'home'</span>][<span class="st">'players'</span>])</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    players_home_df[<span class="st">"teamId"</span>] <span class="op">=</span> data[<span class="st">"matchCentreData"</span>][<span class="st">'home'</span>][<span class="st">'teamId'</span>]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    players_away_df <span class="op">=</span> pd.DataFrame(data[<span class="st">"matchCentreData"</span>][<span class="st">'away'</span>][<span class="st">'players'</span>])</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    players_away_df[<span class="st">"teamId"</span>] <span class="op">=</span> data[<span class="st">"matchCentreData"</span>][<span class="st">'away'</span>][<span class="st">'teamId'</span>]</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    players_df <span class="op">=</span> pd.concat([players_home_df, players_away_df])</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    players_ids <span class="op">=</span> data[<span class="st">"matchCentreData"</span>][<span class="st">"playerIdNameDictionary"</span>]</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> events_dict, players_df, teams_dict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="240b008b-e03f-45d1-bf4b-e1be22f1e843" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>events_dict, players_df, teams_dict <span class="op">=</span> extract_data_from_dict(data_dict)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(events_dict)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>teams_dict</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>home_team_id <span class="op">=</span> <span class="dv">2783</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>away_team_id <span class="op">=</span> <span class="dv">65</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># home_team_id, away_team_id</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e638160e-453d-4d62-b269-d2f776d868ee" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_passes_df(events_dict):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(events_dict)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'eventType'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="st">'type'</span>][<span class="st">'displayName'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'outcomeType'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="st">'outcomeType'</span>][<span class="st">'displayName'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create receiver column based on the next event</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this will be correct only for successfull passes</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"receiver"</span>] <span class="op">=</span> df[<span class="st">"playerId"</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filter only passes</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    passes_ids <span class="op">=</span> df.index[df[<span class="st">'eventType'</span>] <span class="op">==</span> <span class="st">'Pass'</span>]</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    df_passes <span class="op">=</span> df.loc[</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        passes_ids, [<span class="st">"id"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"endX"</span>, <span class="st">"endY"</span>, <span class="st">"teamId"</span>, <span class="st">"playerId"</span>, <span class="st">"receiver"</span>, <span class="st">"eventType"</span>, <span class="st">"outcomeType"</span>]]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_passes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a860e6de-3678-4fa1-83f7-e0ebf05443d9" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>passes_df <span class="op">=</span> get_passes_df(events_dict)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#passes_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="c2b29fee-a598-405b-b7d4-28c5b0528ac4" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_passes_between_df(team_id, passes_df, players_df):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filter for only team</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(team_id)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    passes_df <span class="op">=</span> passes_df[passes_df[<span class="st">"teamId"</span>] <span class="op">==</span> team_id]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add column with first eleven players only</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    passes_df <span class="op">=</span> passes_df.merge(players_df[[<span class="st">"playerId"</span>, <span class="st">"isFirstEleven"</span>]], on<span class="op">=</span><span class="st">'playerId'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filter on first eleven column</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    passes_df <span class="op">=</span> passes_df[passes_df[<span class="st">'isFirstEleven'</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate mean positions for players</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    average_locs_and_count_df <span class="op">=</span> (passes_df.groupby(<span class="st">'playerId'</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                                 .agg({<span class="st">'x'</span>: [<span class="st">'mean'</span>], <span class="st">'y'</span>: [<span class="st">'mean'</span>, <span class="st">'count'</span>]}))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    average_locs_and_count_df.columns <span class="op">=</span> [<span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'count'</span>]</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    average_locs_and_count_df <span class="op">=</span> average_locs_and_count_df.merge(players_df[[<span class="st">'playerId'</span>, <span class="st">'name'</span>, <span class="st">'shirtNo'</span>, <span class="st">'position'</span>]],</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                                                                on<span class="op">=</span><span class="st">'playerId'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    average_locs_and_count_df <span class="op">=</span> average_locs_and_count_df.set_index(<span class="st">'playerId'</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(average_locs_and_count_df)</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the number of passes between each position (using min/ max so we get passes both ways)</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    passes_player_ids_df <span class="op">=</span> passes_df.loc[:, [<span class="st">'id'</span>, <span class="st">'playerId'</span>, <span class="st">'receiver'</span>, <span class="st">'teamId'</span>]]</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    passes_player_ids_df[<span class="st">'pos_max'</span>] <span class="op">=</span> (passes_player_ids_df[[<span class="st">'playerId'</span>, <span class="st">'receiver'</span>]].<span class="bu">max</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    passes_player_ids_df[<span class="st">'pos_min'</span>] <span class="op">=</span> (passes_player_ids_df[[<span class="st">'playerId'</span>, <span class="st">'receiver'</span>]].<span class="bu">min</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get passes between each player</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    passes_between_df <span class="op">=</span> passes_player_ids_df.groupby([<span class="st">'pos_min'</span>, <span class="st">'pos_max'</span>]).<span class="bu">id</span>.count().reset_index()</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    passes_between_df.rename({<span class="st">'id'</span>: <span class="st">'pass_count'</span>}, axis<span class="op">=</span><span class="st">'columns'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add on the location of each player so we have the start and end positions of the lines</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    passes_between_df <span class="op">=</span> passes_between_df.merge(average_locs_and_count_df, left_on<span class="op">=</span><span class="st">'pos_min'</span>, right_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    passes_between_df <span class="op">=</span> passes_between_df.merge(average_locs_and_count_df, left_on<span class="op">=</span><span class="st">'pos_max'</span>, right_index<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>                                                suffixes<span class="op">=</span>[<span class="st">''</span>, <span class="st">'_end'</span>])</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> passes_between_df, average_locs_and_count_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d4393bfd-c149-4f1b-976a-12d173debce2" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#home_passes_between_df, home_average_locs_and_count_df = get_passes_between_df(team_id=home_team_id, passes_df=passes_df, players_df=players_df)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#home_passes_between_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="652c7179-b505-4fa0-a982-bb2ec0c59768" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#away_passes_between_df, away_average_locs_and_count_df = get_passes_between_df(team_id=away_team_id, passes_df=passes_df, players_df=players_df)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#away_passes_between_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="210aae39-ed43-40cc-bbe6-724630c24ee3" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pass_network_visualization(ax, passes_between_df, average_locs_and_count_df, flipped<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    MAX_LINE_WIDTH <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    MAX_MARKER_SIZE <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    passes_between_df[<span class="st">'width'</span>] <span class="op">=</span> (passes_between_df.pass_count <span class="op">/</span> passes_between_df.pass_count.<span class="bu">max</span>() <span class="op">*</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                                  MAX_LINE_WIDTH)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    average_locs_and_count_df[<span class="st">'marker_size'</span>] <span class="op">=</span> (average_locs_and_count_df[<span class="st">'count'</span>]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="op">/</span> average_locs_and_count_df[<span class="st">'count'</span>].<span class="bu">max</span>() <span class="op">*</span> MAX_MARKER_SIZE)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    MIN_TRANSPARENCY <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> np.array(to_rgba(<span class="st">'#507293'</span>))</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> np.tile(color, (<span class="bu">len</span>(passes_between_df), <span class="dv">1</span>))</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    c_transparency <span class="op">=</span> passes_between_df.pass_count <span class="op">/</span> passes_between_df.pass_count.<span class="bu">max</span>()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    c_transparency <span class="op">=</span> (c_transparency <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> MIN_TRANSPARENCY)) <span class="op">+</span> MIN_TRANSPARENCY</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    color[:, <span class="dv">3</span>] <span class="op">=</span> c_transparency</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    pitch <span class="op">=</span> Pitch(pitch_type<span class="op">=</span><span class="st">'opta'</span>, pitch_color<span class="op">=</span><span class="st">'#0D182E'</span>, line_color<span class="op">=</span><span class="st">'#5B6378'</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    pitch.draw(ax<span class="op">=</span>ax)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> flipped:</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        passes_between_df[<span class="st">'x'</span>] <span class="op">=</span> pitch.dim.right <span class="op">-</span> passes_between_df[<span class="st">'x'</span>]</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        passes_between_df[<span class="st">'y'</span>] <span class="op">=</span> pitch.dim.right <span class="op">-</span> passes_between_df[<span class="st">'y'</span>]</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        passes_between_df[<span class="st">'x_end'</span>] <span class="op">=</span> pitch.dim.right <span class="op">-</span> passes_between_df[<span class="st">'x_end'</span>]</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        passes_between_df[<span class="st">'y_end'</span>] <span class="op">=</span> pitch.dim.right <span class="op">-</span> passes_between_df[<span class="st">'y_end'</span>]</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        average_locs_and_count_df[<span class="st">'x'</span>] <span class="op">=</span> pitch.dim.right <span class="op">-</span> average_locs_and_count_df[<span class="st">'x'</span>]</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        average_locs_and_count_df[<span class="st">'y'</span>] <span class="op">=</span> pitch.dim.right <span class="op">-</span> average_locs_and_count_df[<span class="st">'y'</span>]</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    pass_lines <span class="op">=</span> pitch.lines(passes_between_df.x, passes_between_df.y,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>                             passes_between_df.x_end, passes_between_df.y_end, lw<span class="op">=</span>passes_between_df.width,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>                             color<span class="op">=</span>color, zorder<span class="op">=</span><span class="dv">1</span>, ax<span class="op">=</span>ax)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    pass_nodes <span class="op">=</span> pitch.scatter(average_locs_and_count_df.x, average_locs_and_count_df.y,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>                               s<span class="op">=</span>average_locs_and_count_df.marker_size, marker<span class="op">=</span><span class="st">'h'</span>,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>                               color<span class="op">=</span><span class="st">'#FEFEFC'</span>, edgecolors<span class="op">=</span><span class="st">'#FEFEFC'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="dv">1</span>, ax<span class="op">=</span>ax)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, row <span class="kw">in</span> average_locs_and_count_df.iterrows():</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(row)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        player_name <span class="op">=</span> row[<span class="st">"name"</span>].split()</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        player_initials <span class="op">=</span> <span class="st">""</span>.join(word[<span class="dv">0</span>] <span class="cf">for</span> word <span class="kw">in</span> player_name).upper()</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        pitch.annotate(player_initials, xy<span class="op">=</span>(row.x, row.y), c<span class="op">=</span><span class="st">'#C4C4C4'</span>, va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>                       ha<span class="op">=</span><span class="st">'center'</span>, size<span class="op">=</span><span class="dv">14</span>, ax<span class="op">=</span>ax)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pitch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ac63fce3-8e4d-4d4d-b4ac-10016fa4cea5" class="cell" data-execution_count="125">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create plot</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(left<span class="op">=</span><span class="va">None</span>, bottom<span class="op">=</span><span class="va">None</span>, right<span class="op">=</span><span class="va">None</span>, top<span class="op">=</span><span class="va">None</span>, wspace<span class="op">=</span><span class="va">None</span>, hspace<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flat</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>fig.set_facecolor(<span class="st">"#0D182E"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot variables</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>main_color <span class="op">=</span> <span class="st">'#FBFAF5'</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>font_bold <span class="op">=</span> FontManager((<span class="st">"https://github.com/google/fonts/blob/main/apache/roboto/static/"</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"RobotoCondensed-Medium.ttf?raw=true"</span>))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># home team viz</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>pass_network_visualization(axes[<span class="dv">0</span>], home_passes_between_df, home_average_locs_and_count_df)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(teams_dict[home_team_id], color<span class="op">=</span>main_color, fontsize<span class="op">=</span><span class="dv">14</span>)<span class="co">#, fontproperties=font_bold.prop)</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># away team viz</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>pass_network_visualization(axes[<span class="dv">1</span>], away_passes_between_df, away_average_locs_and_count_df, flipped<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(teams_dict[away_team_id], color<span class="op">=</span>main_color, fontsize<span class="op">=</span><span class="dv">14</span>)<span class="co">#, fontproperties=font_bold.prop)</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="ss">f"</span><span class="sc">{</span>teams_dict[home_team_id]<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>teams_dict[away_team_id]<span class="sc">}</span><span class="ss">"</span>, color<span class="op">=</span>main_color, fontsize<span class="op">=</span><span class="dv">42</span>)<span class="co">#, fontproperties=font_bold.prop)</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>subtitle <span class="op">=</span> <span class="st">"Passing networks and top combinations by volume of passes"</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="op">-</span><span class="dv">10</span>, <span class="dv">120</span>, subtitle, horizontalalignment<span class="op">=</span><span class="st">'center'</span>, verticalalignment<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span>main_color, fontsize<span class="op">=</span><span class="dv">14</span>)<span class="co">#, fontproperties=font_bold.prop)</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>x                   40.765
y                80.163333
count                   60
name           Daley Blind
shirtNo                 17
position                DC
marker_size    2432.432432
Name: 70033.0, dtype: object
x                    28.95
y                52.847222
count                   36
name           David López
shirtNo                  5
position                DC
marker_size    1459.459459
Name: 92691.0, dtype: object
x                    11.065909
y                    42.654545
count                       44
name           Paulo Gazzaniga
shirtNo                     13
position                    GK
marker_size        1783.783784
Name: 104732.0, dtype: object
x                     55.165625
y                     39.390625
count                        32
name           Viktor Tsygankov
shirtNo                       8
position                    AMC
marker_size         1297.297297
Name: 231125.0, dtype: object
x                 47.972973
y                 58.371622
count                    74
name           Aleix García
shirtNo                  14
position                 MC
marker_size          3000.0
Name: 280663.0, dtype: object
x                 52.895238
y                 51.328571
count                    21
name           Artem Dovbyk
shirtNo                   9
position                 FW
marker_size      851.351351
Name: 296975.0, dtype: object
x                  36.7675
y                   19.115
count                   40
name           Eric García
shirtNo                 25
position                DC
marker_size    1621.621622
Name: 368091.0, dtype: object
x                46.355102
y                45.373469
count                   49
name           Iván Martín
shirtNo                 23
position                MC
marker_size    1986.486486
Name: 372473.0, dtype: object
x                     50.288462
y                        81.575
count                        52
name           Miguel Gutiérrez
shirtNo                       3
position                    DML
marker_size         2108.108108
Name: 395788.0, dtype: object
x                72.429032
y                83.970968
count                   31
name                 Sávio
shirtNo                 16
position               AMC
marker_size    1256.756757
Name: 397821.0, dtype: object
x                44.634091
y                15.740909
count                   44
name             Yan Couto
shirtNo                 20
position               DMR
marker_size    1783.783784
Name: 421975.0, dtype: object
x                       74.728571
y                       48.585714
count                          14
name           Robert Lewandowski
shirtNo                         9
position                       FW
marker_size                 500.0
Name: 29400.0, dtype: object
x                       53.65
y                   52.645238
count                      84
name           Ilkay Gündogan
shirtNo                    22
position                   MC
marker_size            3000.0
Name: 77464.0, dtype: object
x                 54.862712
y                 82.579661
count                    59
name           João Cancelo
shirtNo                   2
position                 DL
marker_size     2107.142857
Name: 128967.0, dtype: object
x                        43.371429
y                        70.136735
count                           49
name           Andreas Christensen
shirtNo                         15
position                        DC
marker_size                 1750.0
Name: 130331.0, dtype: object
x                    55.828571
y                    46.734524
count                       84
name           Frenkie de Jong
shirtNo                     21
position                    MC
marker_size             3000.0
Name: 279423.0, dtype: object
x                68.476667
y                    16.43
count                   30
name              Raphinha
shirtNo                 11
position               FWR
marker_size    1071.428571
Name: 300447.0, dtype: object
x                 50.176667
y                 13.346667
count                    60
name           Jules Koundé
shirtNo                  23
position                 DR
marker_size     2142.857143
Name: 301019.0, dtype: object
x               67.795238
y               62.785714
count                  21
name           João Félix
shirtNo                14
position              FWL
marker_size         750.0
Name: 362431.0, dtype: object
x                9.368182
y               49.268182
count                  22
name           Iñaki Peña
shirtNo                13
position               GK
marker_size    785.714286
Name: 367164.0, dtype: object
x                   35.22069
y                      41.45
count                     58
name           Ronald Araújo
shirtNo                    4
position                  DC
marker_size      2071.428571
Name: 384711.0, dtype: object
x                61.102083
y                34.091667
count                   48
name                 Pedri
shirtNo                  8
position                MC
marker_size    1714.285714
Name: 402197.0, dtype: object</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-27-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cumulative-xg" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-xg">Cumulative xG</h2>
<div id="d013175e-d4bc-4f0a-a487-05fe098f76eb" class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> font_manager</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'./data/sofascore/shots.json'</span>) <span class="im">as</span> f:</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    shotmap <span class="op">=</span> json.load(f)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>shots <span class="op">=</span> pd.json_normalize(shotmap[<span class="st">"shotmap"</span>])</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#shots</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Barcelona cumulative xG</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>home_xg_cum <span class="op">=</span> shots[shots[<span class="st">"isHome"</span>] <span class="op">==</span> <span class="va">True</span>][[<span class="st">"isHome"</span>, <span class="st">"shotType"</span>, <span class="st">"xg"</span>, <span class="st">"timeSeconds"</span>, <span class="st">"player.name"</span>]]</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>home_xg_cum[<span class="st">"minute"</span>] <span class="op">=</span> <span class="bu">round</span>(home_xg_cum[<span class="st">"timeSeconds"</span>]<span class="op">/</span><span class="dv">60</span>).astype(<span class="bu">int</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>home_xg_cum.sort_values(by<span class="op">=</span><span class="st">"minute"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>home_xg_cum[<span class="st">"xg_cum"</span>] <span class="op">=</span> home_xg_cum[<span class="st">"xg"</span>].cumsum()</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Girona cumulative xG</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>away_xg_cum <span class="op">=</span> shots[shots[<span class="st">"isHome"</span>] <span class="op">==</span> <span class="va">False</span>][[<span class="st">"isHome"</span>, <span class="st">"shotType"</span>, <span class="st">"xg"</span>, <span class="st">"timeSeconds"</span>, <span class="st">"player.name"</span>]]</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>away_xg_cum[<span class="st">"minute"</span>] <span class="op">=</span> <span class="bu">round</span>(away_xg_cum[<span class="st">"timeSeconds"</span>]<span class="op">/</span><span class="dv">60</span>).astype(<span class="bu">int</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>away_xg_cum.sort_values(by<span class="op">=</span><span class="st">"minute"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>away_xg_cum[<span class="st">"xg_cum"</span>] <span class="op">=</span> away_xg_cum[<span class="st">"xg"</span>].cumsum()</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co">#away_xg_cum</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>home_goals <span class="op">=</span> home_xg_cum[home_xg_cum[<span class="st">"shotType"</span>] <span class="op">==</span> <span class="st">"goal"</span>][[<span class="st">"isHome"</span>, <span class="st">"minute"</span>, <span class="st">"player.name"</span>, <span class="st">"xg_cum"</span>]]</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>home_goals[<span class="st">"scorechart"</span>] <span class="op">=</span> home_goals[<span class="st">"minute"</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">"'"</span> <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> home_goals[<span class="st">"player.name"</span>]</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>home_goal_count <span class="op">=</span> <span class="bu">len</span>(home_goals)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>away_goals <span class="op">=</span> away_xg_cum[away_xg_cum[<span class="st">"shotType"</span>] <span class="op">==</span> <span class="st">"goal"</span>][[<span class="st">"isHome"</span>, <span class="st">"minute"</span>, <span class="st">"player.name"</span>, <span class="st">"xg_cum"</span>]]</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>away_goals[<span class="st">"scorechart"</span>] <span class="op">=</span> away_goals[<span class="st">"minute"</span>].astype(<span class="bu">int</span>).astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">"'"</span> <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> away_goals[<span class="st">"player.name"</span>]</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>away_goal_count <span class="op">=</span> <span class="bu">len</span>(away_goals)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co">#away_goals</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>home_xg_total <span class="op">=</span> <span class="bu">round</span>(home_xg_cum[<span class="st">"xg"</span>].<span class="bu">sum</span>(), <span class="dv">2</span>).astype(<span class="bu">str</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>away_xg_total <span class="op">=</span> <span class="bu">round</span>(away_xg_cum[<span class="st">"xg"</span>].<span class="bu">sum</span>(), <span class="dv">2</span>).astype(<span class="bu">str</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2bb32693-083d-4ba9-882e-559167624995" class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_plot_title(suptitle, title):    </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    plt.suptitle(suptitle, fontsize<span class="op">=</span><span class="dv">20</span>, fontproperties<span class="op">=</span>font_properties, y<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    plt.title(title, fontsize<span class="op">=</span><span class="dv">14</span>, fontproperties<span class="op">=</span>font_properties, color<span class="op">=</span><span class="st">"gray"</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annotate_goals(goals):</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> goals.iterrows():</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        facecolor <span class="op">=</span> <span class="st">"blue"</span> <span class="cf">if</span> row[<span class="st">"isHome"</span>] <span class="cf">else</span> <span class="st">"red"</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        plt.text(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>            row[<span class="st">"minute"</span>], </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            row[<span class="st">"xg_cum"</span>] <span class="op">+</span> <span class="fl">0.2</span>, </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>            row[<span class="st">"scorechart"</span>], </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">"center"</span>, </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">"center"</span>, </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>            fontsize<span class="op">=</span><span class="dv">10</span>, </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"white"</span>, </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>            bbox<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                facecolor<span class="op">=</span>facecolor,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                edgecolor<span class="op">=</span><span class="st">"None"</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                boxstyle<span class="op">=</span><span class="st">"round,pad=0.2"</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">6</span>))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>font_properties <span class="op">=</span> font_manager.FontProperties(fname<span class="op">=</span><span class="st">"./fonts/Champions-Bold.ttf"</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>set_plot_title(</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    suptitle<span class="op">=</span><span class="st">"Barcelona 2:4 Girona"</span>, </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"La Liga, 10 December 2023 (Estadi Olímpic Lluís Companys, Spain)"</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">"top"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">"right"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">"bottom"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">"left"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>ax.step(x<span class="op">=</span>home_xg_cum[<span class="st">"minute"</span>], y<span class="op">=</span>home_xg_cum[<span class="st">"xg_cum"</span>], where<span class="op">=</span><span class="st">"post"</span>, color<span class="op">=</span><span class="st">"blue"</span>, label<span class="op">=</span><span class="ss">f"Barcelona </span><span class="sc">{</span>home_xg_total<span class="sc">}</span><span class="ss">"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)  </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>ax.step(x<span class="op">=</span>away_xg_cum[<span class="st">"minute"</span>], y<span class="op">=</span>away_xg_cum[<span class="st">"xg_cum"</span>], where<span class="op">=</span><span class="st">"post"</span>, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span> <span class="ss">f"Girona </span><span class="sc">{</span>away_xg_total<span class="sc">}</span><span class="ss">"</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>ax.scatter(x<span class="op">=</span>home_goals[<span class="st">"minute"</span>], y<span class="op">=</span>home_goals[<span class="st">"xg_cum"</span>], marker<span class="op">=</span><span class="st">"o"</span>, s<span class="op">=</span><span class="dv">200</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>ax.scatter(x<span class="op">=</span>away_goals[<span class="st">"minute"</span>], y<span class="op">=</span>away_goals[<span class="st">"xg_cum"</span>], marker<span class="op">=</span><span class="st">"o"</span>, s<span class="op">=</span><span class="dv">200</span>, color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">90</span>, <span class="dv">105</span>])</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>plt.yticks([<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>])</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">"both"</span>, which<span class="op">=</span><span class="st">"both"</span>, bottom<span class="op">=</span><span class="va">False</span>, top<span class="op">=</span><span class="va">False</span>, left<span class="op">=</span><span class="va">False</span>, right<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">"dotted"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"gray"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="dv">45</span>, color<span class="op">=</span><span class="st">"lightgray"</span>)</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="dv">90</span>, color<span class="op">=</span><span class="st">"lightgray"</span>)</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">42.5</span>, <span class="fl">2.9</span>, <span class="st">"FH"</span>, color<span class="op">=</span><span class="st">"dimgray"</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontproperties<span class="op">=</span>font_properties)</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">87.5</span>, <span class="fl">2.9</span>, <span class="st">"FT"</span>, color<span class="op">=</span><span class="st">"dimgray"</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontproperties<span class="op">=</span>font_properties)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>annotate_goals(home_goals)</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>annotate_goals(away_goals)</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>stat_text_options <span class="op">=</span> <span class="bu">dict</span>(ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, color<span class="op">=</span><span class="st">"dimgray"</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontproperties<span class="op">=</span>font_properties)</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">107</span>, <span class="fl">3.95</span>, <span class="st">"Barcelona"</span>, <span class="op">**</span>stat_text_options)</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">107</span>, <span class="fl">3.8</span>, <span class="ss">f"</span><span class="sc">{</span>home_goal_count<span class="sc">}</span><span class="ss"> goals"</span>, <span class="op">**</span>stat_text_options)</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">107</span>, <span class="fl">3.65</span>, <span class="ss">f"</span><span class="sc">{</span>home_xg_total<span class="sc">}</span><span class="ss"> xG"</span>, <span class="op">**</span>stat_text_options)</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">105</span>, <span class="fl">2.4</span>, <span class="st">"Girona"</span>, <span class="op">**</span>stat_text_options)</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">105</span>, <span class="fl">2.25</span>, <span class="ss">f"</span><span class="sc">{</span>away_goal_count<span class="sc">}</span><span class="ss"> goals"</span>, <span class="op">**</span>stat_text_options)</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">105</span>, <span class="fl">2.1</span>, <span class="ss">f"</span><span class="sc">{</span>away_xg_total<span class="sc">}</span><span class="ss"> xG"</span>, <span class="op">**</span>stat_text_options)</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Cumulative xG"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Minutes"</span>, fontsize<span class="op">=</span><span class="dv">12</span>, labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>home_logo <span class="op">=</span> mpimg.imread(<span class="st">"./img/Barcelona.png"</span>)</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>ax_home_logo <span class="op">=</span> fig.add_axes([<span class="fl">0.82</span>, <span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>])</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>ax_home_logo.imshow(home_logo)</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>ax_home_logo.axis(<span class="st">"off"</span>)</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>away_logo <span class="op">=</span> mpimg.imread(<span class="st">"./img/Girona.png"</span>)</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>ax_away_logo <span class="op">=</span> fig.add_axes([<span class="fl">0.85</span>, <span class="fl">0.62</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>])</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>ax_away_logo.imshow(away_logo)</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>ax_away_logo.axis(<span class="st">"off"</span>)</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"./img/Cumulative_xg.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="radar-chart" class="level2">
<h2 class="anchored" data-anchor-id="radar-chart">Radar chart</h2>
<div id="2bf36df3-2c04-4314-8b43-ee880f65cd1a" class="cell" data-execution_count="87">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>df_understat <span class="op">=</span> pd.read_json(<span class="st">'./data/under_shot_data.json'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>df_sofascore <span class="op">=</span> pd.read_json(<span class="st">'./data/sofa_shot_data.json'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data_scale(data, scaler_type<span class="op">=</span><span class="st">'minmax'</span>):</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.preprocessing <span class="im">import</span> Normalizer</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> scaler_type <span class="op">==</span> <span class="st">'minmax'</span>:</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> scaler_type <span class="op">==</span> <span class="st">'std'</span>:</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> scaler_type <span class="op">==</span> <span class="st">'norm'</span>:</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        scaler <span class="op">=</span> preprocessing.Normalizer()</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    scaler.fit(data)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> scaler.transform(data)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="1448582e-c501-470b-801d-f45383df54b3" class="cell" data-execution_count="94">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_understat.info()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_understat.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 46 entries, 0 to 45
Data columns (total 20 columns):
 #   Column           Non-Null Count  Dtype         
---  ------           --------------  -----         
 0   id               46 non-null     int64         
 1   minute           46 non-null     int64         
 2   result           46 non-null     object        
 3   X                46 non-null     float64       
 4   Y                46 non-null     float64       
 5   xG               46 non-null     float64       
 6   player           46 non-null     object        
 7   h_a              46 non-null     object        
 8   player_id        46 non-null     int64         
 9   situation        46 non-null     object        
 10  season           46 non-null     int64         
 11  shotType         46 non-null     object        
 12  match_id         46 non-null     int64         
 13  h_team           46 non-null     object        
 14  a_team           46 non-null     object        
 15  h_goals          46 non-null     int64         
 16  a_goals          46 non-null     int64         
 17  date             46 non-null     datetime64[ns]
 18  player_assisted  41 non-null     object        
 19  lastAction       46 non-null     object        
dtypes: datetime64[ns](1), float64(3), int64(7), object(9)
memory usage: 7.3+ KB
       id  minute       result      X      Y        xG              player  \
0  553813       4  MissedShots  0.920  0.624  0.027585            Raphinha   
1  553815       6  BlockedShot  0.954  0.412  0.135576  Robert Lewandowski   
2  553817      14  BlockedShot  0.872  0.391  0.076541          João Félix   
3  553818      17    SavedShot  0.969  0.488  0.654123            Raphinha   
4  553819      18         Goal  0.932  0.514  0.126038  Robert Lewandowski   

  h_a  player_id   situation  season   shotType  match_id     h_team  a_team  \
0   h       8026  FromCorner    2023       Head     22835  Barcelona  Girona   
1   h        227    OpenPlay    2023  RightFoot     22835  Barcelona  Girona   
2   h       7892    OpenPlay    2023  RightFoot     22835  Barcelona  Girona   
3   h       8026    OpenPlay    2023   LeftFoot     22835  Barcelona  Girona   
4   h        227  FromCorner    2023       Head     22835  Barcelona  Girona   

   h_goals  a_goals                date player_assisted lastAction  
0        2        4 2023-12-10 20:00:00  Ilkay Gündogan      Cross  
1        2        4 2023-12-10 20:00:00           Pedri       Pass  
2        2        4 2023-12-10 20:00:00           Pedri       Pass  
3        2        4 2023-12-10 20:00:00    João Cancelo      Cross  
4        2        4 2023-12-10 20:00:00        Raphinha      Cross  </code></pre>
</div>
</div>
<div id="6dd498bb-e5fc-4cd3-b0bd-abefb16f448a" class="cell" data-execution_count="95">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data_understat <span class="op">=</span> df_understat[[<span class="st">'player'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'xG'</span>]]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_understat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                player      X      Y        xG
0             Raphinha  0.920  0.624  0.027585
1   Robert Lewandowski  0.954  0.412  0.135576
2           João Félix  0.872  0.391  0.076541
3             Raphinha  0.969  0.488  0.654123
4   Robert Lewandowski  0.932  0.514  0.126038
5             Raphinha  0.864  0.305  0.040520
6           João Félix  0.872  0.596  0.085429
7       Ilkay Gündogan  0.834  0.594  0.055819
8         João Cancelo  0.964  0.601  0.434831
9             Raphinha  0.734  0.540  0.021653
10  Robert Lewandowski  0.952  0.568  0.386009
11            Raphinha  0.927  0.606  0.045518
12     Frenkie de Jong  0.756  0.421  0.024202
13            Raphinha  0.812  0.641  0.110629
14            Raphinha  0.912  0.521  0.101295
15      Ilkay Gündogan  0.741  0.579  0.020296
16            Raphinha  0.834  0.368  0.045099
17      Ilkay Gündogan  0.783  0.557  0.031369
18  Robert Lewandowski  0.943  0.554  0.122883
19      Ilkay Gündogan  0.909  0.812  0.072592
20      Ilkay Gündogan  0.890  0.575  0.098598
21  Robert Lewandowski  0.840  0.515  0.070940
22      Ilkay Gündogan  0.820  0.461  0.061176
23        Jules Koundé  0.782  0.301  0.015336
24      Ilkay Gündogan  0.958  0.532  0.603760
25        Fermín López  0.916  0.502  0.131917
26        Fermín López  0.905  0.517  0.076984
27       Ferrán Torres  0.728  0.590  0.013073
28      Ilkay Gündogan  0.909  0.458  0.103959
29  Robert Lewandowski  0.923  0.521  0.354385
30        Fermín López  0.857  0.382  0.106343
31         David López  0.911  0.556  0.092746
32    Viktor Tsygankov  0.786  0.681  0.024357
33        Artem Dovbyk  0.923  0.545  0.520011
34        Artem Dovbyk  0.902  0.580  0.056151
35    Miguel Gutiérrez  0.925  0.683  0.062417
36    Miguel Gutiérrez  0.898  0.625  0.094226
37    Miguel Gutiérrez  0.854  0.632  0.061740
38    Viktor Tsygankov  0.910  0.517  0.120849
39           Yan Couto  0.868  0.305  0.049720
40    Valery Fernández  0.845  0.504  0.315130
41               Sávio  0.903  0.683  0.400269
42    Cristhian Stuani  0.921  0.390  0.039501
43          Jhon Solis  0.734  0.638  0.015792
44          Jhon Solis  0.930  0.473  0.614128
45    Cristhian Stuani  0.984  0.433  0.470938</code></pre>
</div>
</div>
<div id="bef0e9a1-45e0-4f3a-85f5-3ce553770578" class="cell" data-execution_count="96">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_sofascore.info()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_sofascore.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 46 entries, 0 to 45
Data columns (total 20 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   player                     46 non-null     object 
 1   isHome                     46 non-null     bool   
 2   shotType                   46 non-null     object 
 3   situation                  46 non-null     object 
 4   playerCoordinates          46 non-null     object 
 5   bodyPart                   46 non-null     object 
 6   goalMouthLocation          46 non-null     object 
 7   goalMouthCoordinates       46 non-null     object 
 8   blockCoordinates           24 non-null     object 
 9   xg                         46 non-null     float64
 10  id                         46 non-null     int64  
 11  time                       46 non-null     int64  
 12  addedTime                  7 non-null      float64
 13  timeSeconds                46 non-null     int64  
 14  draw                       46 non-null     object 
 15  reversedPeriodTime         46 non-null     int64  
 16  reversedPeriodTimeSeconds  46 non-null     int64  
 17  incidentType               46 non-null     object 
 18  goalType                   6 non-null      object 
 19  xgot                       18 non-null     float64
dtypes: bool(1), float64(3), int64(5), object(11)
memory usage: 7.0+ KB
                                              player  isHome shotType  \
0  {'name': 'Fermín López', 'firstName': 'Fermín ...    True    block   
1  {'name': 'Cristhian Stuani', 'slug': 'cristhia...   False     goal   
2  {'name': 'Robert Lewandowski', 'firstName': ''...    True     miss   
3  {'name': 'İlkay Gündoğan', 'slug': 'ilkay-gund...    True     goal   
4  {'name': 'Ferran Torres', 'slug': 'ferran-torr...    True     miss   

  situation               playerCoordinates    bodyPart goalMouthLocation  \
0   regular  {'x': 12.9, 'y': 62.2, 'z': 0}  right-foot        low-centre   
1  assisted   {'x': 2.6, 'y': 57.3, 'z': 0}  right-foot         low-right   
2  assisted   {'x': 7.7, 'y': 47.9, 'z': 0}        head       close-right   
3  assisted   {'x': 9.1, 'y': 54.2, 'z': 0}   left-foot          low-left   
4  assisted  {'x': 24.8, 'y': 41.9, 'z': 0}  right-foot       close-right   

             goalMouthCoordinates                blockCoordinates        xg  \
0    {'x': 0, 'y': 51.2, 'z': 19}  {'x': 10.7, 'y': 59.9, 'z': 0}  0.089518   
1    {'x': 0, 'y': 46, 'z': 11.4}                             NaN  0.186681   
2  {'x': 0, 'y': 41.3, 'z': 15.3}                             NaN  0.195696   
3    {'x': 0, 'y': 52.6, 'z': 19}                             NaN  0.134803   
4  {'x': 0, 'y': 41.3, 'z': 13.9}                             NaN  0.024742   

        id  time  addedTime  timeSeconds  \
0  2396401    90        7.0         5791   
1  2396400    90        5.0         5674   
2  2396398    90        3.0         5557   
3  2396394    90        2.0         5474   
4  2396393    90        1.0         5415   

                                                draw  reversedPeriodTime  \
0  {'start': {'x': 62.2, 'y': 12.9}, 'block': {'x...                   1   
1  {'start': {'x': 57.3, 'y': 2.6}, 'end': {'x': ...                   1   
2  {'start': {'x': 47.9, 'y': 7.7}, 'end': {'x': ...                   1   
3  {'start': {'x': 54.2, 'y': 9.1}, 'end': {'x': ...                   1   
4  {'start': {'x': 41.9, 'y': 24.8}, 'end': {'x':...                   1   

   reversedPeriodTimeSeconds incidentType goalType    xgot  
0                        509         shot      NaN     NaN  
1                        626         shot  regular  0.7595  
2                        743         shot      NaN     NaN  
3                        826         shot  regular  0.2616  
4                        885         shot      NaN     NaN  </code></pre>
</div>
</div>
<div id="e8eff6af-d93b-4d33-a7c3-cb8ed9f726c2" class="cell" data-execution_count="97">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>data_sofascore <span class="op">=</span> df_sofascore[[<span class="st">'player'</span>, <span class="st">'playerCoordinates'</span>, <span class="st">'xg'</span>]]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_sofascore.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                              player  \
0  {'name': 'Fermín López', 'firstName': 'Fermín ...   
1  {'name': 'Cristhian Stuani', 'slug': 'cristhia...   
2  {'name': 'Robert Lewandowski', 'firstName': ''...   
3  {'name': 'İlkay Gündoğan', 'slug': 'ilkay-gund...   
4  {'name': 'Ferran Torres', 'slug': 'ferran-torr...   

                playerCoordinates        xg  
0  {'x': 12.9, 'y': 62.2, 'z': 0}  0.089518  
1   {'x': 2.6, 'y': 57.3, 'z': 0}  0.186681  
2   {'x': 7.7, 'y': 47.9, 'z': 0}  0.195696  
3   {'x': 9.1, 'y': 54.2, 'z': 0}  0.134803  
4  {'x': 24.8, 'y': 41.9, 'z': 0}  0.024742  </code></pre>
</div>
</div>
<div id="01a20f62-f7a9-4507-982d-f2e7b98d7ba6" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data_sofascore[<span class="st">'player_name'</span>] <span class="op">=</span> [x[<span class="st">'name'</span>] <span class="cf">for</span> x <span class="kw">in</span> data_sofascore[<span class="st">'player'</span>]]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>data_sofascore[<span class="st">'X'</span>] <span class="op">=</span> [x[<span class="st">'x'</span>] <span class="cf">for</span> x <span class="kw">in</span> data_sofascore[<span class="st">'playerCoordinates'</span>]]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>data_sofascore[<span class="st">'Y'</span>] <span class="op">=</span> [x[<span class="st">'y'</span>] <span class="cf">for</span> x <span class="kw">in</span> data_sofascore[<span class="st">'playerCoordinates'</span>]]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>data_sofascore[<span class="st">'player_name'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="17365b9a-08b8-4dbc-bd94-dd1ce4db9b71" class="cell" data-execution_count="99">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data_sofascore <span class="op">=</span> data_sofascore[[<span class="st">'player_name'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'xg'</span>]]</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_sofascore.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          player_name     X     Y        xg
0        Fermín López  12.9  62.2  0.089518
1    Cristhian Stuani   2.6  57.3  0.186681
2  Robert Lewandowski   7.7  47.9  0.195696
3      İlkay Gündoğan   9.1  54.2  0.134803
4       Ferran Torres  24.8  41.9  0.024742</code></pre>
</div>
</div>
<div id="f1e35982-28fc-467b-a6cd-dd48809d91de" class="cell" data-execution_count="100">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_understat.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               player      X      Y        xG
0            Raphinha  0.920  0.624  0.027585
1  Robert Lewandowski  0.954  0.412  0.135576
2          João Félix  0.872  0.391  0.076541
3            Raphinha  0.969  0.488  0.654123
4  Robert Lewandowski  0.932  0.514  0.126038</code></pre>
</div>
</div>
<div id="d6c77b64-da1c-46e3-bb14-e2a324eb2817" class="cell" data-execution_count="101">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(data_understat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>46</code></pre>
</div>
</div>
<div id="1aa2a9d4-fe2d-4479-a19c-d25090999398" class="cell" data-execution_count="102">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(data_sofascore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>46</code></pre>
</div>
</div>
<div id="6be15db3-48ea-449d-b187-950d4b6f58c3" class="cell" data-execution_count="103">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(data_understat[<span class="st">'player'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>{'Artem Dovbyk',
 'Cristhian Stuani',
 'David López',
 'Fermín López',
 'Ferrán Torres',
 'Frenkie de Jong',
 'Ilkay Gündogan',
 'Jhon Solis',
 'João Cancelo',
 'João Félix',
 'Jules Koundé',
 'Miguel Gutiérrez',
 'Raphinha',
 'Robert Lewandowski',
 'Sávio',
 'Valery Fernández',
 'Viktor Tsygankov',
 'Yan Couto'}</code></pre>
</div>
</div>
<div id="8114e789-a59b-4a7c-92b5-1d1ce372c882" class="cell" data-execution_count="104">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(data_sofascore[<span class="st">'player_name'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>{'Artem Dovbyk',
 'Cristhian Stuani',
 'David López',
 'Fermín López',
 'Ferran Torres',
 'Frenkie de Jong',
 'Jhon Solís',
 'João Cancelo',
 'João Félix',
 'Jules Koundé',
 'Miguel Gutiérrez',
 'Raphinha',
 'Robert Lewandowski',
 'Sávio',
 'Valery Fernández',
 'Viktor Tsygankov',
 'Yan Couto',
 'İlkay Gündoğan'}</code></pre>
</div>
</div>
<div id="13202bb7-ee30-4181-b719-b9993ad5870e" class="cell" data-execution_count="105">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>data_understat.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="105">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">xG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>46.000000</td>
<td>46.000000</td>
<td>46.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.876217</td>
<td>0.528065</td>
<td>0.156358</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.069200</td>
<td>0.108335</td>
<td>0.181039</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.728000</td>
<td>0.301000</td>
<td>0.013073</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.835500</td>
<td>0.464000</td>
<td>0.045203</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.902500</td>
<td>0.536000</td>
<td>0.081206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.923000</td>
<td>0.595500</td>
<td>0.130447</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>0.984000</td>
<td>0.812000</td>
<td>0.654123</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ecc03c0e-0279-48bc-af66-cb25af29dd14" class="cell" data-execution_count="106">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>data_sofascore.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="106">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">xg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>46.000000</td>
<td>46.000000</td>
<td>46.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>12.200000</td>
<td>47.452174</td>
<td>0.135148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>6.578382</td>
<td>10.731133</td>
<td>0.142474</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>2.600000</td>
<td>18.800000</td>
<td>0.009018</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>7.700000</td>
<td>40.475000</td>
<td>0.044768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>9.600000</td>
<td>46.500000</td>
<td>0.084365</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>16.525000</td>
<td>53.400000</td>
<td>0.159605</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>26.600000</td>
<td>69.900000</td>
<td>0.694513</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="58c4198b-f457-4157-8b53-00d0c681b33b" class="cell" data-execution_count="107">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data_sofascore_scaled <span class="op">=</span> data_scale(data_sofascore[[<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'xg'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="6cd6e55d-6bce-4c42-820c-773c355ba654" class="cell" data-execution_count="108">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data_sofascore_scaled <span class="op">=</span> pd.DataFrame(data_sofascore_scaled, columns<span class="op">=</span>[<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'xg'</span>])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_sofascore_scaled.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          X         Y        xg
0  0.429167  0.849315  0.117434
1  0.000000  0.753425  0.259174
2  0.212500  0.569472  0.272326
3  0.270833  0.692759  0.183495
4  0.925000  0.452055  0.022938</code></pre>
</div>
</div>
<div id="1d4c5cc9-5011-442b-b292-6c2f31d7a420" class="cell" data-execution_count="109">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Функція для побудови графіка типу павутиння</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> radar_chart(ax, data, label, color):</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    angles <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(data), endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.concatenate((data, [data[<span class="dv">0</span>]]))  <span class="co"># Замикання кола</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    angles <span class="op">=</span> np.concatenate((angles, [angles[<span class="dv">0</span>]]))  <span class="co"># Замикання кола</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    ax.plot(angles, data, label<span class="op">=</span>label, color<span class="op">=</span>color)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    ax.fill(angles, data, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span>color)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2c32d1b2-937b-45a8-8eb2-1470f9000494" class="cell" data-execution_count="110">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Дані категорій (імена гравців). Треба привести імена до одного - İlkay Gündoğan</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>categories_understat <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(data_understat[<span class="st">'player'</span>]))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>categories_sofascore <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(data_sofascore[<span class="st">'player_name'</span>]))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудувати графік 1</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, polar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>radar_chart(ax1, data_understat[<span class="st">'X'</span>], <span class="st">'Набір даних X understat'</span>, <span class="st">'blue'</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(categories_understat), endpoint<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(categories_understat)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Набір даних X understat'</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудувати графік 2</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, polar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>radar_chart(ax2, data_sofascore_scaled[<span class="st">'X'</span>], <span class="st">'Набір даних X sofascore'</span>, <span class="st">'orange'</span>)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(categories_sofascore), endpoint<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(categories_sofascore)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Набір даних X sofascore'</span>)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Показати графіки</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="072515f4-e807-415e-abf3-d72b391b7508" class="cell" data-execution_count="111">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудувати графік 1</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, polar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>radar_chart(ax1, data_understat[<span class="st">'Y'</span>], <span class="st">'Набір даних Y understat'</span>, <span class="st">'blue'</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(categories_understat), endpoint<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(categories_understat)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Набір даних Y understat'</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудувати графік 2</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, polar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>radar_chart(ax2, data_sofascore_scaled[<span class="st">'Y'</span>], <span class="st">'Набір даних Y sofascore'</span>, <span class="st">'orange'</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(categories_sofascore), endpoint<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(categories_sofascore)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Набір даних Y sofascore'</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Показати графіки</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="2ba9b6cd-a6b7-4e64-b520-d0bce6c1683d" class="cell" data-execution_count="112">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудувати графік 1</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, polar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>radar_chart(ax1, data_understat[<span class="st">'xG'</span>], <span class="st">'Набір даних XG understat'</span>, <span class="st">'blue'</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(categories_understat), endpoint<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(categories_understat)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Набір даних XG understat'</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудувати графік 2</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, polar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>radar_chart(ax2, data_sofascore_scaled[<span class="st">'xg'</span>], <span class="st">'Набір даних XG sofascore'</span>, <span class="st">'orange'</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="bu">len</span>(categories_sofascore), endpoint<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(categories_sofascore)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Набір даних XG sofascore'</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Показати графіки</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparison-of-player-statistics" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-player-statistics">Comparison of player statistics</h2>
<div id="cbcf95ef-d565-4795-b18d-25e2533bd29e" class="cell" data-execution_count="114">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Путь к JSON файлам с данными игроков</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>player1_file <span class="op">=</span> <span class="st">'./data/player_match_data_11736.json'</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>player2_file <span class="op">=</span> <span class="st">'./data/player_match_data_227.json'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="7de13945-2d57-4bf4-8ded-b585a5400364" class="cell" data-execution_count="116">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Загрузка данных об игроках</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>player1_stats <span class="op">=</span> pd.read_json(player1_file)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>player2_stats <span class="op">=</span> pd.read_json(player2_file)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Создание DataFrame для удобства анализа и визуализации</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame(player1_stats)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame(player2_stats)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">#print(df1.describe())</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">#df1.info()</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#print(df1.head())</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#print(df2.describe())</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#df2.info()</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#print(df2.head())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d249a35f-b62d-4e74-bde9-79bcfbf42a84" class="cell" data-execution_count="118">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Имена показателей статистики</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>stats_labels <span class="op">=</span> [ <span class="st">'shots'</span>, <span class="st">'xG'</span>, <span class="st">'time'</span>, <span class="st">'position'</span>, <span class="st">'goals'</span>, <span class="st">'xA'</span>, <span class="st">'assists'</span>, <span class="st">'key_passes'</span>, <span class="st">'npg'</span>, <span class="st">'npxG'</span>, <span class="st">'xGChain'</span>, <span class="st">'xGBuildup'</span>]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Значения показателей статистики для каждого игрока</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>player1_values <span class="op">=</span> [df1[label].iloc[<span class="dv">0</span>] <span class="cf">for</span> label <span class="kw">in</span> stats_labels]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>player2_values <span class="op">=</span> [df2[label].iloc[<span class="dv">0</span>] <span class="cf">for</span> label <span class="kw">in</span> stats_labels]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Углы для графика типа радар</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(stats_labels)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>angles <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> np.pi, num_vars, endpoint<span class="op">=</span><span class="va">False</span>).tolist()</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Добавление первого элемента в конец списка, чтобы график был замкнутым</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>player1_values <span class="op">+=</span> player1_values[:<span class="dv">1</span>]</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>player2_values <span class="op">+=</span> player2_values[:<span class="dv">1</span>]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>angles <span class="op">+=</span> angles[:<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="587ebc02-b34d-4458-9f77-99e7b61055ae" class="cell" data-execution_count="119">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Построение графика типа радар</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>), subplot_kw<span class="op">=</span><span class="bu">dict</span>(polar<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>ax.fill(angles, player1_values, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">'Artem Dovbyk'</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>ax.fill(angles, player2_values, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">'Robert Lewandowski'</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([])</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(angles[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(stats_labels, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>, fontsize<span class="op">=</span><span class="st">'large'</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Player Statistics'</span>, size<span class="op">=</span><span class="dv">16</span>, weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Barcelona-Girona_files/figure-html/cell-53-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>